// Agentic OS â€” Master Configuration
// JSON5 format: comments allowed, trailing commas OK, unquoted keys permitted.
// Validated against the AgenticOsConfig schema in @agentic-os/core.
{
  gateway: {
    nats: {
      url: "nats://localhost:4222",
    },
    redis: {
      url: "redis://localhost:6379",
    },
    websocket: {
      port: 18789,
    },
    maxConcurrentAgents: 5,
    ui: { enabled: true, title: "Agent OS" },
  },

  agents: {
    defaults: {
      model: "pi-mono",
      contextWindow: 128000,
      maxTurns: 100,
    },
    list: [
      {
        id: "assistant",
        name: "Assistant",
        description: "General-purpose assistant that can delegate research to the researcher agent",
        persona: "You are a helpful assistant. You have access to a researcher agent via the agent_send tool. When the user asks a question that would benefit from deep research or analysis, delegate it to the researcher by calling agent_send with targetAgent: 'researcher' and waitForReply: true. Synthesize the researcher's reply into your final answer.",
        tools: { allow: ["*"] },
      },
      {
        id: "researcher",
        name: "Researcher",
        description: "Research specialist that investigates topics in depth",
        persona: "You are a research specialist. When you receive a message from another agent, investigate the topic thoroughly using your available tools. Be detailed and cite your sources. Return a comprehensive answer.",
        tools: { allow: ["*"] },
      },
    ],
  },

  bindings: [
    { channel: "default", agentId: "assistant" },
  ],

  models: {
    providers: [
      {
        id: "pi-mono",
        type: "pi-mono",
        models: ["claude-sonnet-4-20250514"],
        profiles: ["default"],
      },
    ],
    fallbacks: [],
  },

  auth: {
    profiles: [
      {
        id: "default",
        provider: "anthropic",
        apiKeyEnv: "ANTHROPIC_API_KEY",
      },
    ],
  },

  session: {
    idleTimeoutMs: 1800000, // 30 minutes
    maxHistoryEntries: 1000,
    compaction: {
      enabled: true,
      reserveTokens: 20000,
    },
  },

  tools: {
    allow: ["*"],
    deny: [],
    mcpServers: [
      // {
      //   name: "example",
      //   transport: "stdio",
      //   command: "npx",
      //   args: ["-y", "@example/mcp-server"],
      // },
    ],
  },

  sandbox: {
    mode: "off",
    scope: "session",
    docker: {
      image: "agentic-os-sandbox:latest",
      memoryLimit: "512m",
      cpuLimit: "1.0",
      pidsLimit: 256,
      networkMode: "none",
      readOnlyRoot: true,
      tmpfsSize: "100m",
      timeout: 30,
    },
  },

  plugins: {
    directories: [],
    enabled: [],
    disabled: [],
  },

  skills: {
    directories: [],
    enabled: [],
    disabled: [],
  },

  channels: {
    adaptors: {},
  },

  orchestrator: {
    // maxConcurrentAgents: 5,   // falls back to gateway.maxConcurrentAgents
    spawnTimeoutMs: 120000,       // 2 minutes
    sendReplyTimeoutMs: 120000,   // 2 minutes
    maxExchanges: 5,
  },

  memory: {
    enabled: true,
    embedding: {
      provider: 'auto',             // 'auto' | 'openai' | 'none'
      dimensions: 1024,
      model: 'text-embedding-3-large',
      apiKeyEnv: 'OPENAI_API_KEY',
      batchSize: 64,
    },
    search: {
      vectorWeight: 0.7,
      bm25Weight: 0.3,
      decayHalfLifeDays: 30,
      mmrLambda: 0.6,
      defaultMaxResults: 10,
    },
    chunking: {
      targetTokens: 400,
      overlapTokens: 80,
      maxChunkTokens: 600,
    },
    importanceScoring: {
      enabled: true,
      defaultImportance: 0.5,
    },
    dailyLog: {
      enabled: true,
      directory: 'memory',
    },
  },
}
