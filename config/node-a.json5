// Node A — runs the assistant agent (user-facing)
// The assistant can delegate to "researcher" which lives on Node B.
// Since "researcher" is not in this node's agent list, the FederatedAgentRegistry
// will route via NATS automatically.
{
  gateway: {
    nats: { url: "nats://localhost:4222" },
    redis: { url: "redis://localhost:6379" },
    websocket: { port: 18789 },
    maxConcurrentAgents: 5,
    ui: { enabled: true, title: "Agent OS — Node A (Assistant)" },
  },

  agents: {
    defaults: {
      model: "pi-mono",
      contextWindow: 128000,
      maxTurns: 100,
    },
    list: [
      {
        id: "assistant",
        name: "Assistant",
        description: "General-purpose assistant that delegates research to a remote researcher agent",
        persona: "You are a helpful assistant. You have access to a researcher agent via the agent_send tool. When the user asks a question that would benefit from deep research or analysis, delegate it to the researcher by calling agent_send with targetAgent: 'researcher' and waitForReply: true. Synthesize the researcher's reply into your final answer.",
        tools: { allow: ["*"] },
      },
    ],
  },

  bindings: [
    { channel: "default", agentId: "assistant" },
  ],

  models: {
    providers: [
      {
        id: "pi-mono",
        type: "pi-mono",
        models: ["claude-sonnet-4-20250514"],
        profiles: ["default"],
      },
    ],
    fallbacks: [],
  },

  auth: {
    profiles: [
      { id: "default", provider: "anthropic", apiKeyEnv: "ANTHROPIC_API_KEY" },
    ],
  },

  session: {
    idleTimeoutMs: 1800000,
    maxHistoryEntries: 1000,
    compaction: { enabled: true, reserveTokens: 20000 },
  },

  tools: {
    allow: ["*"],
    deny: [],
    mcpServers: [],
  },

  sandbox: {
    mode: "off",
    scope: "session",
    docker: {
      image: "agentic-os-sandbox:latest",
      memoryLimit: "512m",
      cpuLimit: "1.0",
      pidsLimit: 256,
      networkMode: "none",
      readOnlyRoot: true,
      tmpfsSize: "100m",
      timeout: 30,
    },
  },

  plugins: { directories: [], enabled: [], disabled: [] },
  skills: { directories: [], enabled: [], disabled: [] },
  channels: { adaptors: {} },

  orchestrator: {
    spawnTimeoutMs: 120000,
    sendReplyTimeoutMs: 120000,
    maxExchanges: 5,
    remoteDispatchTimeoutMs: 120000,
  },

  memory: {
    enabled: true,
    embedding: {
      provider: 'auto',
      dimensions: 1024,
      model: 'text-embedding-3-large',
      apiKeyEnv: 'OPENAI_API_KEY',
      batchSize: 64,
    },
    search: {
      vectorWeight: 0.7,
      bm25Weight: 0.3,
      decayHalfLifeDays: 30,
      mmrLambda: 0.6,
      defaultMaxResults: 10,
    },
    chunking: { targetTokens: 400, overlapTokens: 80, maxChunkTokens: 600 },
    importanceScoring: { enabled: true, defaultImportance: 0.5 },
    dailyLog: { enabled: true, directory: 'memory' },
  },
}
